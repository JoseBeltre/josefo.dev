---
import { workflow } from '../../data/workflow';
import Badge from '../Badge.astro';
import WorkflowStep from '../WorkflowStep.astro';
---

<section id="proceso" class="px-6 md:px-0">
  <Badge>
    Proceso
  </Badge>
  <h2 class="section-title">As√≠ trabajaremos juntos</h2>
  <div class="steps-wrapper grid gap-3 lg:grid-cols-5 lg:gap-5">
  {
    workflow.map(step => 
      <WorkflowStep
        step={step.id},
        title={step.title},
        description={step.description}
      />
    )
  }
  </div>
</section>
<script>
  import { gsap } from 'gsap'
  import { ScrollTrigger } from 'gsap/all'

  gsap.registerPlugin(ScrollTrigger)

  const stepsWrapper = document.querySelector('.steps-wrapper')
  const articles = stepsWrapper?.querySelectorAll('article')

  const isMobile = () => window.innerWidth <= 765


  if (articles) {
    if (isMobile()) {
      articles.forEach(step => {
        gsap.from(step, {
          scrollTrigger: {
            trigger: step,
            start: 'top bottom',
            end: 'bottom top',
            toggleActions: 'play none none none',
          },
        scale: .2,
        ease: 'power.inOut',
        duration: .3
        })
      })
    } else {
      gsap.from(articles, {
      scrollTrigger: {
        trigger: stepsWrapper,
        start: 'top bottom',
        end: 'bottom top',
        toggleActions: 'play none none none',
      },
      scale: .2,
      ease: 'back.inOut',
      stagger: .1
      })
    }
  }
</script>